
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>New product Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../webdashboards/" />
    
    
    <link rel="prev" href="overview.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Products</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../products/appstores/">
            
                <a href="../../products/appstores/">
            
                    
                    App stores
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../products/appstores/new_release_android.html">
            
                <a href="../../products/appstores/new_release_android.html">
            
                    
                    New Android release
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../../products/appstores/new_release_ios.html">
            
                <a href="../../products/appstores/new_release_ios.html">
            
                    
                    New iOS release
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../products/firefox_android/">
            
                <a href="../../products/firefox_android/">
            
                    
                    Firefox for Android
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../../products/firefox_android/adding_singlelocale.html">
            
                <a href="../../products/firefox_android/adding_singlelocale.html">
            
                    
                    Single-locale builds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../../products/firefox_android/adding_multilocales.html">
            
                <a href="../../products/firefox_android/adding_multilocales.html">
            
                    
                    Multi-locales build
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../products/firefox_desktop/">
            
                <a href="../../products/firefox_desktop/">
            
                    
                    Firefox for Desktop
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../../products/firefox_desktop/adding_nightly.html">
            
                <a href="../../products/firefox_desktop/adding_nightly.html">
            
                    
                    Nightly builds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../../products/firefox_desktop/adding_release.html">
            
                <a href="../../products/firefox_desktop/adding_release.html">
            
                    
                    Beta/Release builds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../../products/firefox_desktop/removing_locales.html">
            
                <a href="../../products/firefox_desktop/removing_locales.html">
            
                    
                    Removing locales
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../products/firefox_iOS/">
            
                <a href="../../products/firefox_iOS/">
            
                    
                    Firefox for iOS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../products/firefox_iOS/review_iOSstrings.html">
            
                <a href="../../products/firefox_iOS/review_iOSstrings.html">
            
                    
                    Reviewing new strings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../../products/mozilla_org/">
            
                <a href="../../products/mozilla_org/">
            
                    
                    Mozilla.org
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="../../products/mozilla_org/working_bedrock.html">
            
                <a href="../../products/mozilla_org/working_bedrock.html">
            
                    
                    Working with Bedrock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="../webdashboards/import_translations.html">
            
                <a href="../webdashboards/import_translations.html">
            
                    
                    Importing translations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="../../products/mozilla_org/updating_mozillaorg_production.html">
            
                <a href="../../products/mozilla_org/updating_mozillaorg_production.html">
            
                    
                    Updating production
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="../../products/mozilla_org/enable_production.html">
            
                <a href="../../products/mozilla_org/enable_production.html">
            
                    
                    New locales
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../../products/searchplugins/setup_searchplugins.html">
            
                <a href="../../products/searchplugins/setup_searchplugins.html">
            
                    
                    Searchplugins
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Tools</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../pontoon/">
            
                <a href="../pontoon/">
            
                    
                    Pontoon
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../pontoon/adding_new_project.html">
            
                <a href="../pontoon/adding_new_project.html">
            
                    
                    New project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../pontoon/adding_new_locale.html">
            
                <a href="../pontoon/adding_new_locale.html">
            
                    
                    New locale
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../pontoon/sending_notifications.html">
            
                <a href="../pontoon/sending_notifications.html">
            
                    
                    Notifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../pontoon/renaming_a_file.html">
            
                <a href="../pontoon/renaming_a_file.html">
            
                    
                    Renaming a localization file
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="./">
            
                <a href="./">
            
                    
                    Stores webapp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="overview.html">
            
                <a href="overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.2.2" data-path="add_new_product.html">
            
                <a href="add_new_product.html">
            
                    
                    New product
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../webdashboards/">
            
                <a href="../webdashboards/">
            
                    
                    Web dashboards
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../webdashboards/langchecker.html">
            
                <a href="../webdashboards/langchecker.html">
            
                    
                    Langchecker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../webdashboards/webdashboard.html">
            
                <a href="../webdashboards/webdashboard.html">
            
                    
                    Webdashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../webdashboards/bootstrap_new_locale.html">
            
                <a href="../webdashboards/bootstrap_new_locale.html">
            
                    
                    Bootstrap a new locale
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../webdashboards/add_locales.html">
            
                <a href="../webdashboards/add_locales.html">
            
                    
                    Add locales to an existing file
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.5" data-path="../webdashboards/update_existing_file.html">
            
                <a href="../webdashboards/update_existing_file.html">
            
                    
                    Update an existing file
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.6" data-path="../webdashboards/add_new_file.html">
            
                <a href="../webdashboards/add_new_file.html">
            
                    
                    Add a new file to an existing project
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Misc</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../mercurial/">
            
                <a href="../mercurial/">
            
                    
                    Mercurial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../mercurial/setting_mercurial_environment.html">
            
                <a href="../mercurial/setting_mercurial_environment.html">
            
                    
                    Set up the environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../mercurial/creating_mercurial_patch.html">
            
                <a href="../mercurial/creating_mercurial_patch.html">
            
                    
                    Create a patch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../mercurial/useful_mercurial_commands.html">
            
                <a href="../mercurial/useful_mercurial_commands.html">
            
                    
                    Useful Mercurial commands
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../misc/">
            
                <a href="../../misc/">
            
                    
                    Other docs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../misc/creating_new_repository.html">
            
                <a href="../../misc/creating_new_repository.html">
            
                    
                    New l10n repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../misc/working_w_l10n_agency.html">
            
                <a href="../../misc/working_w_l10n_agency.html">
            
                    
                    How to work with a Localization Agency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../../misc/documentation_styleguide.html">
            
                <a href="../../misc/documentation_styleguide.html">
            
                    
                    Documentation styleguide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../../misc/stock_emails.html">
            
                <a href="../../misc/stock_emails.html">
            
                    
                    Stock emails
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../../config/setup_l10ndrivers_vm.html">
            
                <a href="../../config/setup_l10ndrivers_vm.html">
            
                    
                    L10n-drivers VM setup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >New product</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="how-to-add-a-new-product-to-stores">How to add a new product to Stores</h1>
<p>Before starting, make sure to read the <a href="overview.html">overview</a> document to get a general idea of what this web app does and its structure.</p>
<p>This document will explain how to start tracking a new project, using Focus for Android as an example.</p>
<h2 id="add-new-product-to-configuration">Add new product to configuration</h2>
<p>Configuration for the Stores web app is split between <code>app/config/product_sources.json</code> and the <code>Project</code> class (<code>app/classes/Stores/Project.php</code>). The first thing to do is to determine:</p>
<ul>
<li>How many channels are supported.</li>
<li>Code name and displayed name for this product.</li>
<li>If the product needs to support App Store (apple) or Play Store (google).</li>
</ul>
<p>Let&#x2019;s start with <code>app/config/product_sources.json</code>. This is a JSON file with the following structure:</p>
<pre><code class="lang-JSON">{
  <span class="hljs-string">&quot;product code name&quot;</span>: [
    {
      <span class="hljs-string">&quot;channel&quot;</span>: <span class="hljs-string">&quot;name of the channel&quot;</span>,
      <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;format of the remote list&quot;</span>,
      <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;URL of the remote list&quot;</span>
    }
  ]
}
</code></pre>
<p>The only <code>format</code> supported at the moment is <code>txt</code>: a plain text file with one locale code per line.</p>
<p>If the project is tracked on <a href="https://l10n.mozilla-community.org/webstatus/" target="_blank">Webstatus</a>, you can use its <a href="https://github.com/mozilla-l10n/webstatus/#available-urls" target="_blank">API</a> to get the list of all locales available (<a href="https://l10n.mozilla-community.org/webstatus/api/?product=focus-android&amp;txt" target="_blank">example</a> for Focus for Android).</p>
<p>This is the configuration to add to the file for Focus for Android:</p>
<pre><code class="lang-JSON"><span class="hljs-string">&quot;focus_android&quot;</span>: [
  {
    <span class="hljs-string">&quot;channel&quot;</span>: <span class="hljs-string">&quot;release&quot;</span>,
    <span class="hljs-string">&quot;format&quot;</span>: <span class="hljs-string">&quot;txt&quot;</span>,
    <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;https://l10n.mozilla-community.org/webstatus/api/?product=focus-android&amp;txt&quot;</span>
  }
]
</code></pre>
<p>If you&#x2019;re not used to work with JSON files, once you have updated the configuration, you can use a <a href="https://jsonlint.com/" target="_blank">validator</a> to ensure that the syntax is correct.</p>
<p>Now that <code>app/config/product_sources.json</code> contains Focus for Android, you need to run <code>apps/scripts/update_shipping_locales.py</code> to generate the list of locales shipping in this new product.
The list of locales will be stored in <code>app/config/shipping_locales.json</code>, make sure that the product and channel you&#x2019;ve added are available, and spot check the list of locales generated.</p>
<p>At this point you need to work on <code>app/classes/Stores/Project.php</code>. This is the configuration for Focus for Android:</p>
<pre><code class="lang-PHP"><span class="hljs-keyword">private</span> $products_data = [
...
    <span class="hljs-string">&apos;focus_android&apos;</span> =&gt;
        [
            <span class="hljs-string">&apos;channels&apos;</span> =&gt; [<span class="hljs-string">&apos;release&apos;</span>],
            <span class="hljs-string">&apos;name&apos;</span>     =&gt; <span class="hljs-string">&apos;Focus for Android&apos;</span>,
            <span class="hljs-string">&apos;store&apos;</span>    =&gt; <span class="hljs-string">&apos;google&apos;</span>,
        ],
...
];
</code></pre>
<p>The next step is to add which templates and .lang files will be used for this project. In case of Focus for Android there is:</p>
<ul>
<li><code>template</code>: PHP file used to display the full information about this product.</li>
<li><code>listing</code>: .lang file containing the strings used in template (description, keywords, etc.).</li>
<li><code>screenshots</code>: .lang file used to localize screenshots. It&#x2019;s distinct from the main .lang file in order to support only a subset of languages.</li>
</ul>
<p>Since it&#x2019;s the first launch for Focus for Android, a <code>whatsnew</code> entry won&#x2019;t be needed, but it will be starting from the first update.</p>
<p><strong>Important</strong>: follow the naming convention of existing products.</p>
<p>Here&#x2019;s how the <code>focus_android</code> entry will look like:</p>
<pre><code class="lang-PHP"><span class="hljs-keyword">private</span> $$templates = [
...
    <span class="hljs-string">&apos;focus_android&apos;</span> =&gt; [
        <span class="hljs-string">&apos;release&apos;</span> =&gt; [
            <span class="hljs-string">&apos;template&apos;</span>    =&gt; <span class="hljs-string">&apos;focus_android/release/listing_mar_2017.php&apos;</span>,
            <span class="hljs-string">&apos;listing&apos;</span>     =&gt; <span class="hljs-string">&apos;focus_android/description_release.lang&apos;</span>,
            <span class="hljs-string">&apos;screenshots&apos;</span> =&gt; <span class="hljs-string">&apos;focus_android/screenshots_v1.lang&apos;</span>,
        ],
    ],
...
];
</code></pre>
<h2 id="add-templates">Add templates</h2>
<p>Now that the configuration is done, you need to add the actual template file. Templates are stored in <code>app/templates</code>, and the easiest way to start is by copying an existing project. In this case you can copy templates from Focus for iOS, making sure to rename the folder to <code>focus_android</code>, and the template to <code>listing_mar_2017.php</code> (as specified in the configuration above).</p>
<p>This is the initial part of the template:</p>
<pre><code class="lang-PHP"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Stores</span>;

<span class="hljs-comment">// Include closure needed in template</span>
<span class="hljs-keyword">include</span> INC . <span class="hljs-string">&apos;utilities.php&apos;</span>;

$app_title = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($translations)</span> <span class="hljs-title">use</span> <span class="hljs-params">($_)</span> </span>{
    <span class="hljs-keyword">return</span> $_(<span class="hljs-string">&apos;Firefox Focus: The privacy browser&apos;</span>);
};

$description = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($translations)</span> <span class="hljs-title">use</span> <span class="hljs-params">($_)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;OUT
<span class="hljs-subst">{$_(&apos;Browse like no one&#x2019;s watching.&apos;)}</span> <span class="hljs-subst">{$_(&apos;The new Firefox Focus automatically blocks a wide range of online trackers &#x2014; from the moment you launch it to the second you leave it.&apos;)}</span> <span class="hljs-subst">{$_(&apos;Easily erase your history, passwords and cookies, so you won&#x2019;t get followed by things like unwanted ads.&apos;)}</span>

<span class="hljs-subst">{$_(&apos;&#x201C;Private browsing&#x201D; on most browsers isn&#x2019;t comprehensive or easy to use.&apos;)}</span> <span class="hljs-subst">{$_(&apos;Focus is next-level privacy that&#x2019;s free, always on and always on your side &#x2014; because it&#x2019;s backed by Mozilla, the non-profit that fights for your rights on the Web.&apos;)}</span>

<span class="hljs-subst">{$_(&apos;AUTOMATIC PRIVACY&apos;)}</span>
&#x2022; <span class="hljs-subst">{$_(&apos;Blocks a wide range of common Web trackers without any settings to set&apos;)}</span>
&#x2022; <span class="hljs-subst">{$_(&apos;Easily erases your history &#x2014; no passwords, no cookies, no trackers&apos;)}</span>

<span class="hljs-subst">{$_(&apos;BROWSE FASTER&apos;)}</span>
&#x2022; <span class="hljs-subst">{$_(&apos;By removing trackers and ads, Web pages may require less data and load faster&apos;)}</span>

<span class="hljs-subst">{$_(&apos;MADE BY MOZILLA&apos;)}</span>
&#x2022; <span class="hljs-subst">{$_(&apos;We believe everyone should have control over their lives online. That&#x2019;s what we&#x2019;ve been fighting for since 1998.&apos;)}</span>
OUT;</span>
};
...
</code></pre>
<p>The first lines are common to all templates: they define the <code>namespace</code> and include a set of helper functions. Then, each section of the template is defined as a variable that returns translations for selected strings. The simplest case is:</p>
<pre><code class="lang-PHP">$app_title = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($translations)</span> <span class="hljs-title">use</span> <span class="hljs-params">($_)</span> </span>{
    <span class="hljs-keyword">return</span> $_(<span class="hljs-string">&apos;Firefox Focus: The privacy browser&apos;</span>);
};
</code></pre>
<p><code>$app_title</code> is defined as a function that returns the translation, using the helper function <code>$_()</code>, for only one string.</p>
<p>In case there are more strings in a section, <a href="https://php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc" target="_blank">HEREDOC</a> syntax can be used.</p>
<pre><code class="lang-PHP">$screenshots = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($translations)</span> <span class="hljs-title">use</span> <span class="hljs-params">($_)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;OUT
<span class="hljs-subst">{$_(&apos;Automatically block ads&lt;br&gt;&amp; other Web trackers&apos;)}</span>

<span class="hljs-subst">{$_(&apos;Browse Faster&lt;br&gt;Web pages may load faster&lt;br&gt;by removing trackers&apos;)}</span>
OUT;</span>
};
</code></pre>
<p>Associating a group of strings to a variable allows to count the total number of characters for a section, and see if it&#x2019;s longer than allowed.</p>
<p>Pay attention to the log when testing a new template that you&#x2019;ve copied from another product, some functions and variables are exclusive of a specific store, for example:</p>
<ul>
<li><code>$keywords_warning</code> is defined only for App Stores projects.</li>
<li><code>$short_desc</code> is defined only for Play Store projects.</li>
</ul>
<h2 id="add-views">Add views</h2>
<p>The next step is to add a view for each channel supported for this product. Views are stored in <code>views/product_name/channel</code>, in case of Focus for Android <code>views/focus_android/release</code>. There are 2 files to create:</p>
<ul>
<li><code>locale_view.php</code>: used for <em>General view</em>.</li>
<li><code>locale_view_escaped.php</code>: used for <em>Description raw HTML</em>. It&#x2019;s the same content as <code>locale_view.php</code>, but each element is included in <code>&lt;pre &lt;?= $direction ?&gt; contenteditable=&quot;true&quot;&gt;&lt;/pre&gt;</code> elements.</li>
</ul>
<p>As for templates, the easiest way to start is by copying files from an existing product.</p>
<p>This is how the first part of <code>locale_view.php</code> looks like:</p>
<pre><code class="lang-PHP">&lt;h1&gt;Focus <span class="hljs-keyword">for</span> Android Listing Copy (<span class="hljs-meta">&lt;?</span>= $request[<span class="hljs-string">&apos;locale&apos;</span>] <span class="hljs-meta">?&gt;</span>)&lt;/h1&gt;

&lt;h3&gt;Title &amp;mdash; <span class="hljs-meta">&lt;?</span>= $title_warning <span class="hljs-meta">?&gt;</span>&lt;/h3&gt;
&lt;pre <span class="hljs-meta">&lt;?</span>= $direction <span class="hljs-meta">?&gt;</span>&gt;<span class="hljs-meta">&lt;?</span>= $app_title($translations) <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;

&lt;h3&gt;Short Description &amp;mdash; <span class="hljs-meta">&lt;?</span>= $short_desc_warning <span class="hljs-meta">?&gt;</span>&lt;/h3&gt;
&lt;pre <span class="hljs-meta">&lt;?</span>= $direction <span class="hljs-meta">?&gt;</span>&gt;<span class="hljs-meta">&lt;?</span>= $short_desc($translations) <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;
</code></pre>
<p>As you can see, it simply calls the variables created inside the template. The interesting part is that you can add more complex logic in this file:</p>
<pre><code class="lang-PHP">&lt;?php
    /*
        Check if the file used for screenshots exists, display this section
        only in that case.
    */
    $screenshot_lang = $project-&gt;getLangFiles($request[&apos;locale&apos;], $request[&apos;product&apos;], $request[&apos;channel&apos;], &apos;screenshots&apos;);
    if ($screenshot_lang) {
        $locale_file = LOCALES_PATH . $request[&apos;locale&apos;] . &apos;/&apos; . array_shift($screenshot_lang);
        if (file_exists($locale_file)) {
            ?&gt;
            &lt;h3&gt;Screenshots&lt;/h3&gt;
            &lt;pre &lt;?= $direction ?&gt; class=&quot;text-center&quot;&gt;&lt;?= $screenshots($translations) ?&gt;&lt;/pre&gt;
&lt;?php

        }
    }
?&gt;
</code></pre>
<p>In this case, the screenshots session is displayed only if the requested locale actually has screenshots, i.e. if the file specified in the configuration is available.</p>
<p><code>locale_view_escaped.php</code> is exactly the same as the default view, only using a different HTML structure to make copy and paste easier. For example, the same section displayed above becomes:</p>
<pre><code class="lang-PHP">&lt;h1&gt;Focus <span class="hljs-keyword">for</span> Android Listing Copy (<span class="hljs-meta">&lt;?</span>= $request[<span class="hljs-string">&apos;locale&apos;</span>] <span class="hljs-meta">?&gt;</span>)&lt;/h1&gt;

&lt;h3&gt;Title &amp;mdash; <span class="hljs-meta">&lt;?</span>= $title_warning <span class="hljs-meta">?&gt;</span>&lt;/h3&gt;
&lt;pre <span class="hljs-meta">&lt;?</span>= $direction <span class="hljs-meta">?&gt;</span> contenteditable=<span class="hljs-string">&quot;true&quot;</span>&gt;<span class="hljs-meta">&lt;?</span>= htmlspecialchars($app_title($translations)) <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;

&lt;h3&gt;Short Description &amp;mdash; <span class="hljs-meta">&lt;?</span>= $short_desc_warning <span class="hljs-meta">?&gt;</span>&lt;/h3&gt;
&lt;pre <span class="hljs-meta">&lt;?</span>= $direction <span class="hljs-meta">?&gt;</span> contenteditable=<span class="hljs-string">&quot;true&quot;</span>&gt;<span class="hljs-meta">&lt;?</span>= $short_desc($translations) <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;
</code></pre>
<p>As for the templates, pay attention to differences between a product shipping on Play Store and one shipping on App Stores:</p>
<ul>
<li>For Android products there should be length warnings on title, short description, and description. For iOS, a warning should be displayed on keywords.</li>
<li>There are no keywords in Android, short description is not available for iOS products.</li>
</ul>
<h2 id="tests">Tests</h2>
<p>It&#x2019;s not mandatory to add new tests, since they normally cover functionalities and not data. Adding a simple API test in <code>tests/functional/api.php</code> is highly suggested. For example:</p>
<pre><code class="lang-PHP">$paths = [
...
    [<span class="hljs-string">&apos;v1/focus_android/done/release/&apos;</span>, <span class="hljs-number">200</span>, <span class="hljs-keyword">false</span>],
...
</code></pre>
<p>Some tests will need to be updated, for example <code>testGetSupportedProducts</code> in <a href="https://github.com/mozilla-l10n/stores_l10n/blob/master/tests/units/Store/Project.php" target="_blank">tests/units/Store/Project.php</a>. In case, unit tests are run as part of the automation when opening a pull request.</p>
<h2 id="track-lang-files-in-langchecker">Track .lang files in Langchecker</h2>
<p>The Stores web app is going to use .lang files from the <a href="https://github.com/mozilla-l10n/appstores" target="_blank">appstores repository</a>. This document won&#x2019;t go into much detail about these configuration files, if you&#x2019;re not familiar with Langchecker you should read <a href="../webdashboard/add_new_file-md">this document</a> first.</p>
<p>In the configuration two .lang file are associated to Focus for Android:</p>
<ul>
<li><code>focus_android/description_release.lang</code> for the main content.</li>
<li><code>focus_android/screenshots_v1.lang</code> for screenshots.</li>
</ul>
<p>First you need to create a new <code>$focus_android_locales</code> array in <code>app/config/stores_locales.inc.php</code>.</p>
<pre><code class="lang-PHP"><span class="hljs-comment">// Locales working on Focus for Android (from stores_l10n app)</span>
$cache_id = <span class="hljs-string">&apos;focus_android_locales&apos;</span>;
<span class="hljs-keyword">if</span> (! $focus_android_locales = Cache::getKey($cache_id, <span class="hljs-number">60</span> * <span class="hljs-number">60</span>)) {
    $focus_android_locales = $json_object
        -&gt;setURI(STORES_L10N . <span class="hljs-string">&apos;focus_android/supportedlocales/release&apos;</span>)
        -&gt;fetchContent();
    $focus_android_locales = array_intersect($focus_android_locales, $mozilla);
    Cache::setKey($cache_id, $focus_android_locales);
}
</code></pre>
<p>This code retrieves, via API from the Stores web app, the list of locales supported for Focus for Android release. Then:</p>
<pre><code class="lang-PHP">$focus_android_store = array_intersect($focus_android_locales, $google_play_locales);
</code></pre>
<p>This intersects the list of locales shipping in Focus for Android with the list of locales supported in Play Store, and stores the resulting array in <code>$focus_android_store</code>.</p>
<p>Then you need to start tracking the new files in <code>app/config/sources.inc.php</code>:</p>
<pre><code class="lang-PHP">$appstores_lang = [
    <span class="hljs-string">&apos;focus_android/description_release.lang&apos;</span> =&gt; [
        <span class="hljs-string">&apos;supported_locales&apos;</span> =&gt; $focus_android_store,
    ],
    <span class="hljs-string">&apos;focus_android/screenshots_v1.lang&apos;</span> =&gt; [
        <span class="hljs-string">&apos;supported_locales&apos;</span> =&gt; [
            <span class="hljs-string">&apos;es-ES&apos;</span>, <span class="hljs-string">&apos;id&apos;</span>, <span class="hljs-string">&apos;pt-BR&apos;</span>, <span class="hljs-string">&apos;ru&apos;</span>,
        ],
    ],
...
];
</code></pre>
<p>Once the configuration is complete, you&#x2019;ll need to create the actual .lang files and add them to the appstores repository with <code>lang_update</code>.</p>
<h2 id="adding-a-whats-new-section">Adding a What&#x2019;s new section</h2>
<p>As already explained, you won&#x2019;t need a <em>What&#x2019;s new</em> section for a newly launched product. For further updates, you will need to add a <code>whatsnew</code> entry in the project configuration.</p>
<pre><code class="lang-PHP"><span class="hljs-keyword">private</span> $$templates = [
...
    <span class="hljs-string">&apos;focus_android&apos;</span> =&gt; [
        <span class="hljs-string">&apos;release&apos;</span> =&gt; [
            <span class="hljs-string">&apos;template&apos;</span>    =&gt; <span class="hljs-string">&apos;focus_android/release/listing_mar_2017.php&apos;</span>,
            <span class="hljs-string">&apos;listing&apos;</span>     =&gt; <span class="hljs-string">&apos;focus_android/description_release.lang&apos;</span>,
            <span class="hljs-string">&apos;screenshots&apos;</span> =&gt; <span class="hljs-string">&apos;focus_android/screenshots_v1.lang&apos;</span>,
            <span class="hljs-string">&apos;whatsnew&apos;</span>    =&gt; <span class="hljs-string">&apos;focus_android/whatsnew/focus_v2.lang&apos;</span>,
        ],
    ],
...
];
</code></pre>
<p>Then manage this content in the template:</p>
<pre><code class="lang-PHP">$whatsnew = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($translations)</span> <span class="hljs-title">use</span> <span class="hljs-params">($_)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&lt;&lt;&lt;OUT
* <span class="hljs-subst">{$_(&apos;A brand new feature&apos;)}</span>
OUT;</span>
</code></pre>
<p>And use this <code>$whatsnew</code> variable in all available views.</p>
<pre><code class="lang-PHP">&lt;h3&gt;What&#x2019;s <span class="hljs-keyword">new</span> &amp;mdash; <span class="hljs-meta">&lt;?</span>= $whatsnew_warning <span class="hljs-meta">?&gt;</span>&lt;/h3&gt;
&lt;pre <span class="hljs-meta">&lt;?</span>= $direction <span class="hljs-meta">?&gt;</span>&gt;<span class="hljs-meta">&lt;?</span>= $whatsnew($translations) <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;
</code></pre>
<h2 id="testing">Testing</h2>
<p>When all tools and repositories are ready, make sure to test everything locally and check PHP logs before opening a pull request. It&#x2019;s strongly recommended to use a virtual machine set up following these <a href="../../config/setup_l10ndrivers_vm.html">instructions</a> running all needed tools.</p>
<p>A good way to test it is to provide a fake translation for one locale, slightly altering the translated strings, to check if all views and API calls work as expected.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="overview.html" class="navigation navigation-prev " aria-label="Previous page: Overview">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../webdashboards/" class="navigation navigation-next " aria-label="Next page: Web dashboards">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"New product","level":"3.2.2","depth":2,"next":{"title":"Web dashboards","level":"3.3","depth":1,"path":"tools/webdashboards/README.md","ref":"tools/webdashboards/README.md","articles":[{"title":"Langchecker","level":"3.3.1","depth":2,"path":"tools/webdashboards/langchecker.md","ref":"tools/webdashboards/langchecker.md","articles":[]},{"title":"Webdashboard","level":"3.3.2","depth":2,"path":"tools/webdashboards/webdashboard.md","ref":"tools/webdashboards/webdashboard.md","articles":[]},{"title":"Bootstrap a new locale","level":"3.3.3","depth":2,"path":"tools/webdashboards/bootstrap_new_locale.md","ref":"tools/webdashboards/bootstrap_new_locale.md","articles":[]},{"title":"Add locales to an existing file","level":"3.3.4","depth":2,"path":"tools/webdashboards/add_locales.md","ref":"tools/webdashboards/add_locales.md","articles":[]},{"title":"Update an existing file","level":"3.3.5","depth":2,"path":"tools/webdashboards/update_existing_file.md","ref":"tools/webdashboards/update_existing_file.md","articles":[]},{"title":"Add a new file to an existing project","level":"3.3.6","depth":2,"path":"tools/webdashboards/add_new_file.md","ref":"tools/webdashboards/add_new_file.md","articles":[]}]},"previous":{"title":"Overview","level":"3.2.1","depth":2,"path":"tools/stores_l10n/overview.md","ref":"tools/stores_l10n/overview.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-lunr","-search","search-pro"],"pluginsConfig":{"search-pro":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"tools/stores_l10n/add_new_product.md","mtime":"2017-09-22T11:05:03.654Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-09-22T11:06:05.597Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

